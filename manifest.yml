# Example language specification

# foobar:
#   template_files:
#     - Dockerfile # automatically added if not included
#     - .env
#   defaults:
#     sqlite_version: 3
#   versions:
#     '3':
#       sqlite_version: 2 # overrides the 3 from defaults above
#     '4':

# Coordinate with owner(s) of canvadocs before upgrades (currently the Content team)
appliances/libreoffice:
  defaults:
    ubuntu_version: bionic
  versions:
    '6.2':
      full_version: '6.2.7.1'
    '6.3':
      full_version: '6.3.1.2'

appliances/debugging:
  versions:
    xenial: {}
    bionic: {}

appliances/postgres:
  defaults:
    decoderbufs_ref: 'v0.9.2.Final'
    wal2json_ref: 'master'
  versions:
    '9.5':
      base_image: postgres:9.5
    '9.6':
      base_image: postgres:9.6
    '10':
      base_image: postgres:10
    '11':
      base_image: postgres:11

clojure:
  versions:
    '11':
      java_version: '11'
      lein_version: '2.9.1'
      package_sha: 'a4c239b407576f94e2fef5bfa107f0d3f97d0b19c253b08860d9609df4ab8b29'
      jar_sha: 'ea7c831a4f5c38b6fc3926c6ad32d1d4b9b91bf830a715ecff5a70a18bda55f8'

core:
  defaults:
    flavor: slim
  versions:
    bionic:
      base_image: ubuntu:bionic
      flavor: fat
    bionic-slim:
      base_image: ubuntu:bionic
    focal:
      base_image: ubuntu:focal

golang:
  defaults:
    base_image: 'instructure/core:focal'
  versions:
    '1.16':  # supported until 1.18 is out
      full_version: '1.16.9'
      package_sha: 'd2c095c95f63c2a3ef961000e0ecb9d81d5c68b6ece176e2a8a2db82dc02931c'
    '1.17':  # supported until 1.19 is out
      full_version: '1.17.2'
      package_sha: 'f242a9db6a0ad1846de7b6d94d507915d14062660616a61ef7c808a76e4f1676'

graalvm-ce:
  defaults:
    distro: focal
  versions:
    '19-java11':
      java_version: 11
      graal_version: 19.3.5
      package_sha: 4936cdf48cd501e9df7ff41929774bd1cd88aecb41c3fbf2c970b29c340bbc95
    '21-java11':
      java_version: 11
      graal_version: 21.0.0.2
      package_sha: bd3fbe796e803c4fe5cd089371588d3d716fa3cdb653fe8dd6dba31b57bef934

java:
  defaults:
    distro: bionic
  versions:
    '11':
      java_version: 11
      flavor: jdk
    '11-jre':
      java_version: 11
      flavor: jre
    '16':
      distro: focal
      java_version: 16
      flavor: jdk
    '16-jre':
      distro: focal
      java_version: 16
      flavor: jre
    '17':
      distro: focal
      java_version: 17
      flavor: jdk
    '17-jre':
      distro: focal
      java_version: 17
      flavor: jre

# We are no longer accepting new minor version tags for Node images, simply
# update the corresponding major version tag (4, 6, 8) to the latest minor.
node: &NODE
  defaults:
    base_distro: focal
    base_image: instructure/core:focal
    npm_version: latest
    yarn_version: latest
  versions:
    '12':  # Supported until 04/30/2022
      node_version: '12'
      base_distro: bionic
      base_image: instructure/core:bionic
    '14':  # Supported until 04/30/2023
      node_version: '14'
      base_distro: focal
      base_image: instructure/core:focal
    '16':  # Supported until 04/30/2024
      node_version: '16'
      base_distro: focal
      base_image: instructure/core:focal

node-passenger:
  defaults:
    base_distro: focal
    base_image: instructure/core:focal
    npm_version: latest
    yarn_version: latest
  versions:
    '12':  # Supported until 04/30/2022
      base_distro: bionic
      base_image: instructure/core:bionic
      node_version: '12'
    '14':  # Supported until 04/30/2023
      node_version: '14'
      base_distro: focal
      base_image: instructure/core:focal
  # <<: *NODE

node-pm2:
  defaults:
    base_distro: bionic
    base_image: instructure/node:12
  versions:
    '12':
      base_image: instructure/node:12
    '14':
      base_image: instructure/node:14
      base_distro: focal
    # '16':
      # base_image: instructure/node:16
      # base_distro: focal

php: &PHP
  defaults:
    base_image: instructure/core:bionic-slim
  versions:
    '7.3-focal':
      base_image: instructure/core:focal
    '7.3':
      base_image: instructure/core:bionic
    '7.3-slim': {}

php-nginx:
  versions:
    '7.3-focal': {}
    '7.3': {}
    '7.3-slim': {}

python: &PYTHON
  defaults:
    base_image: instructure/core:bionic
  versions:
    '3.7':
      python_version: 3.7.5
      python_build_version: 3.7
      pip_version: 20.1
      python_pgp_key_id: 0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D

ruby: &RUBY
  defaults:
    base_distro: bionic
    base_image: instructure/core:bionic
    bundler_version: 1.17.3
    rubygems_version: 2.7.11
  versions:
    '2.5':
    '2.6':
    '2.7-bionic':
      base_distro: bionic
      base_image: instructure/core:bionic
      bundler_version: 2.2.6
      rubygems_version: 3.2.6
    '2.7':
      base_distro: focal
      base_image: instructure/core:focal
      bundler_version: 2.2.6
      rubygems_version: 3.2.6

ruby-node-pg:
  defaults:
    base_distro: bionic
    npm_version: latest
    yarn_version: latest
  versions:
    '2.6-node14':
      node_version: '14'
      ruby_version: '2.6'

ruby-passenger:
  defaults:
    base_distro: bionic
  versions:
    '2.5':
    '2.6':
    '2.6-p6.0.4':
      passenger_version: 1:6.0.4-1~bionic1
      version_override: "2.6"
      # https://github.com/phusion/passenger/issues/2281 is blocking some users
    '2.7-bionic':
    '2.7':
      base_distro: focal

scala-sbt:
  defaults:
    base_image: instructure/java:11
  template_files:
    - Dockerfile
    - sbt-private
  versions:
    '1.3':
      full_version: '1.3.3'
      minor_version: '1.3'
      major_version: '1.0'

tini:
  defaults:
    base_image: alpine
    gpg_key: 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7
  versions:
    'v0.16.1':
    'v0.18.0':
    'v0.19.0':
